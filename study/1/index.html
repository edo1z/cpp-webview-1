<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C++ Webview プロジェクト解説</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/theme/black.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/monokai.min.css">
    <style>
        .reveal pre {
            font-size: 0.6em;
            box-shadow: none;
        }
        .reveal pre code {
            max-height: 500px;
        }
        .reveal h1, .reveal h2, .reveal h3 {
            color: #42affa;
        }
        .reveal .progress {
            color: #42affa;
        }
        .small-code pre {
            font-size: 0.5em !important;
        }
        .file-path {
            text-align: left;
            margin-left: 20px;
            color: #71C5E8;
            font-size: 0.7em;
            margin-bottom: -10px;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- スライド1: タイトル -->
            <section>
                <h1>C++ Webview プロジェクト</h1>
                <h3>Hello World アプリケーション解説</h3>
                <p>TDD（テスト駆動開発）による実装</p>
            </section>

            <!-- スライド2: プロジェクト構造 -->
            <section>
                <h2>プロジェクト構造</h2>
                <pre><code class="language-plaintext">cpp-webview-1/
├── CMakeLists.txt      # ビルド設定
├── include/            # ヘッダファイル
│   └── webview_app.h
├── src/                # ソースコード
│   ├── webview_app.cpp
│   └── main.cpp
├── tests/              # テストコード
│   └── test_webview_app.cpp
├── web/                # Webリソース
│   └── index.html
├── build/              # ビルド出力
├── .gitignore          # Git除外設定
├── .mcp.json           # MCP設定
└── CLAUDE.md           # 開発ガイドライン</code></pre>
            </section>

            <!-- スライド3: CMakeLists.txt解説 -->
            <section>
                <h2>CMakeLists.txt (1/2)</h2>
                <p class="file-path">CMakeLists.txt</p>
                <pre><code class="language-cmake">cmake_minimum_required(VERSION 3.16)
project(cpp_webview_1)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# プラットフォーム固有の設定
if(WIN32)
    add_definitions(-DWEBVIEW_WINAPI)
elseif(APPLE)
    add_definitions(-DWEBVIEW_COCOA)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -framework WebKit")
else()
    add_definitions(-DWEBVIEW_GTK)
    find_package(PkgConfig REQUIRED)
    pkg_check_modules(GTK3 REQUIRED gtk+-3.0)
    pkg_check_modules(WEBKIT2 REQUIRED webkit2gtk-4.1)
endif()</code></pre>
                <p>プラットフォームごとの設定を自動検出</p>
            </section>

            <!-- スライド4: CMakeLists.txt解説続き -->
            <section>
                <h2>CMakeLists.txt (2/2)</h2>
                <p class="file-path">CMakeLists.txt</p>
                <div class="small-code">
                <pre><code class="language-cmake"># webviewライブラリをダウンロード
include(FetchContent)
FetchContent_Declare(
    webview
    URL https://github.com/webview/webview/archive/refs/heads/master.zip
)
FetchContent_MakeAvailable(webview)

# 実行ファイル
add_executable(cpp_webview_hello ${SOURCES})

# Google Testをダウンロード
FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/refs/tags/v1.14.0.zip
)
FetchContent_MakeAvailable(googletest)</code></pre>
                </div>
                <p>外部ライブラリの自動ダウンロード機能</p>
            </section>

            <!-- スライド5: WebviewAppクラスのヘッダ -->
            <section>
                <h2>WebviewApp クラス定義</h2>
                <p class="file-path">include/webview_app.h</p>
                <pre><code class="language-cpp">#ifndef WEBVIEW_APP_H
#define WEBVIEW_APP_H

#include &lt;string&gt;
#include &lt;memory&gt;

class WebviewApp {
public:
    WebviewApp(const std::string& title, int width, int height);
    ~WebviewApp();

    void run();
    void setHtml(const std::string& html);
    
    std::string getTitle() const { return title_; }
    int getWidth() const { return width_; }
    int getHeight() const { return height_; }

private:
    std::string title_;
    int width_;
    int height_;
    void* webview_;
};

#endif // WEBVIEW_APP_H</code></pre>
            </section>

            <!-- スライド6: WebviewApp実装 -->
            <section>
                <h2>WebviewApp 実装</h2>
                <p class="file-path">src/webview_app.cpp</p>
                <pre><code class="language-cpp">#include "webview_app.h"
#include "webview.h"

WebviewApp::WebviewApp(const std::string& title, int width, int height) 
    : title_(title), width_(width), height_(height), webview_(nullptr) {
    webview_ = webview_create(false, nullptr);
    webview_set_title(webview_, title_.c_str());
    webview_set_size(webview_, width_, height_, WEBVIEW_HINT_NONE);
}

WebviewApp::~WebviewApp() {
    if (webview_) {
        webview_destroy(webview_);
    }
}

void WebviewApp::setHtml(const std::string& html) {
    if (webview_) {
        webview_set_html(webview_, html.c_str());
    }
}</code></pre>
            </section>

            <!-- スライド7: テストコード -->
            <section>
                <h2>TDDによるテスト</h2>
                <p class="file-path">tests/test_webview_app.cpp</p>
                <pre><code class="language-cpp">#include &lt;gtest/gtest.h&gt;
#include "webview_app.h"

TEST(WebviewAppTest, CanCreate) {
    WebviewApp app("Hello World Test", 800, 600);
    EXPECT_TRUE(true);
}

TEST(WebviewAppTest, HasCorrectTitle) {
    WebviewApp app("Test Title", 800, 600);
    EXPECT_EQ(app.getTitle(), "Test Title");
}

TEST(WebviewAppTest, HasCorrectDimensions) {
    WebviewApp app("Test", 1024, 768);
    EXPECT_EQ(app.getWidth(), 1024);
    EXPECT_EQ(app.getHeight(), 768);
}</code></pre>
                <p>Red → Green → Refactor のサイクル</p>
            </section>

            <!-- スライド8: メイン関数 -->
            <section>
                <h2>メイン関数</h2>
                <p class="file-path">src/main.cpp</p>
                <pre><code class="language-cpp">std::string loadHtmlFile(const std::string& filepath) {
    std::ifstream file(filepath);
    if (!file.is_open()) {
        return "&lt;h1&gt;Error: Could not load HTML file&lt;/h1&gt;";
    }
    
    std::stringstream buffer;
    buffer << file.rdbuf();
    return buffer.str();
}

int main() {
    try {
        WebviewApp app("Hello World", 800, 600);
        
        // HTMLファイルを読み込む
        std::string html = loadHtmlFile("../web/index.html");
        app.setHtml(html);
        
        // アプリケーションを実行
        app.run();
        
    } catch (const std::exception& e) {
        std::cerr << "Error: " << e.what() << std::endl;
        return 1;
    }
    
    return 0;
}</code></pre>
            </section>

            <!-- スライド9: HTMLファイル -->
            <section>
                <h2>HTMLコンテンツ</h2>
                <p class="file-path">web/index.html</p>
                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Hello World&lt;/title&gt;
    &lt;style&gt;
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        h1 {
            font-size: 3rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;h1&gt;Hello World!&lt;/h1&gt;
        &lt;p&gt;C++ Webviewアプリケーションへようこそ&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </section>

            <!-- スライド10: ビルドと実行 -->
            <section>
                <h2>ビルドと実行</h2>
                <pre><code class="language-bash"># ビルドディレクトリを作成
mkdir build
cd build

# CMakeでプロジェクトを設定
cmake ..

# ビルド実行
make -j$(nproc)

# テスト実行
./test_runner

# アプリケーション実行
./cpp_webview_hello</code></pre>
                <p>テストが全てパスしてからアプリケーションを実行</p>
            </section>

            <!-- スライド11: 開発プラクティス -->
            <section>
                <h2>開発プラクティス (CLAUDE.md)</h2>
                <h3>TDD（t-wada流）の実践</h3>
                <ol>
                    <li><strong>Red</strong>: 失敗するテストを書く</li>
                    <li><strong>Green</strong>: テストを通す最小限の実装</li>
                    <li><strong>Refactor</strong>: コードを改善</li>
                </ol>
                <h3>品質保証</h3>
                <ul>
                    <li>全てのテストがパスすることを確認</li>
                    <li>ビルドエラー・警告を修正してからコミット</li>
                    <li>LSPツールのエラー・警告をチェック</li>
                </ul>
            </section>

            <!-- スライド12: まとめ -->
            <section>
                <h2>まとめ</h2>
                <h3>このプロジェクトで学んだこと</h3>
                <ul>
                    <li>C++でのクロスプラットフォームGUI開発</li>
                    <li>Webview技術の活用</li>
                    <li>CMakeによるモダンなビルドシステム</li>
                    <li>Google Testを使ったTDD</li>
                    <li>きれいなプロジェクト構造の重要性</li>
                </ul>
                <p>シンプルだが拡張可能な基盤が完成！</p>
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/highlight.min.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            plugins: [ RevealHighlight ],
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade'
        });
    </script>
</body>
</html>