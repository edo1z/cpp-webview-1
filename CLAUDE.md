# C++ Webview プロジェクト

このプロジェクトはC++とWebviewを使用したGUIアプリケーション開発プロジェクトです。

## 開発環境
- OS: Windows 11 + WSL2 (Ubuntu)
- 言語: C++
- GUI: Webview (Qt6は使用しません)

## ビルド設定
- ビルドシステム: CMakeを使用
- C++標準: C++17以上を推奨
- コンパイラ: GCC/Clang

## プロジェクト構造
```
.
├── applications/      # 各学習アプリケーション
│   ├── 01_hello_world/
│   │   ├── CMakeLists.txt
│   │   ├── README.md
│   │   ├── build/       # ビルド出力
│   │   ├── include/     # ヘッダーファイル
│   │   ├── src/         # ソースコード
│   │   ├── tests/       # テストコード
│   │   └── web/         # HTML/JS/CSSリソース
│   └── 02_counter/      # (以降同様の構造)
├── CLAUDE.md         # プロジェクト全体の指針
└── README.md         # プロジェクト概要
```

各アプリケーションは独立したCMakeプロジェクトとして構成され、個別にビルド可能です。

## コーディング規約
- インデント: スペース4つ
- 命名規則:
  - クラス名: PascalCase
  - 関数名: camelCase
  - 変数名: snake_case
  - 定数: UPPER_SNAKE_CASE

## Webview実装時の注意事項
- webviewライブラリを使用（https://github.com/webview/webview）
- JavaScriptとC++間の通信は`webview::bind`を使用してバインディング
- セキュリティ: 外部URLへのアクセスは必要最小限に制限
- プラットフォーム別の依存関係:
  - Linux: GTK3とWebKit2GTK（`sudo apt install libgtk-3-dev libwebkit2gtk-4.1-dev`）
  - macOS: WebKitフレームワーク（標準搭載）
  - Windows: Microsoft Edge WebView2（別途インストール）

## ビルド手順

### 個別アプリケーションのビルド
```bash
cd applications/01_hello_world
mkdir build
cd build
cmake ..
make
./hello_world  # 実行
```

### テストの実行
```bash
ctest  # buildディレクトリ内で実行
# または
./hello_world_test
```

## テスト
- Google Testを使用してユニットテストを実装
- 各アプリケーションのbuildディレクトリ内で`ctest`または個別の実行ファイルで実行
- TDDサイクルに従い、Red→Green→Refactorの順で開発

## 開発プラクティス

### TDD（テスト駆動開発）
**t-wada流のTDDで開発を進める**
1. **Red**: 失敗するテストを書く
2. **Green**: テストを通す最小限の実装
3. **Refactor**: コードを改善

### コミット粒度
- 機能単位で小まめにコミット
- 各ステップ（Red→Green→Refactor）でコミットすることを推奨

### 品質保証
- **コミット前の必須確認事項**:
  - 全てのテストがパスすることを確認
  - テストをパスさせるための無益な修正は行わない
  - ビルドエラー・警告を修正してからコミット
  - **LSPツールのエラー・警告チェック**:
    ```bash
    # アプリケーションディレクトリ内で実行
    cd applications/01_hello_world
    
    # clang-tidyで全ソースファイルの警告を確認
    clang-tidy src/*.cpp tests/*.cpp -- \
      -I./include \
      -I./build/_deps/googletest-src/googletest/include \
      -I./build/_deps/webview-src \
      -x c++ -std=c++17 2>&1 | \
      grep -E "(warning|error):" | grep -v "generated"
    
    # 特定のファイルだけチェックする場合
    clang-tidy src/webview_app.cpp -- -I./include -x c++ -std=c++17
    ```
  - 上記コマンドで検出されたエラー・警告を全て修正してからコミット
  - 主な警告タイプ:
    - `cppcoreguidelines-special-member-functions`: Rule of Five（デストラクタ定義時は5つの特殊メンバ関数を考慮）
    - `modernize-*`: C++17の機能を活用した改善提案
    - `bugprone-*`: バグになりやすいコードパターン
    - `performance-*`: パフォーマンス改善の提案
- メモリリークチェックを定期的に実施（Valgrind等を使用）

## 学習プロジェクト一覧と進捗

JavaScript-C++連携機能を段階的に学習するためのアプリケーションプロジェクトです。

### アプリケーションの作成方法
1. `applications`ディレクトリに新しいフォルダを作成（例: `02_counter`）
2. 01_hello_worldの構造を参考に必要なファイルを配置
3. TDDで開発を進める
4. 完成後、下記のチェックリストを更新

### 完了済みプロジェクト（基礎的なJS-C++連携）
- [x] **01. Hello World** - 基本的なWebview表示 ✅ 完了
- [x] **02. カウンターアプリ** - `webview::bind`によるJS→C++呼び出し ✅ 完了
- [x] **03. テキストエコー** - 文字列データの双方向通信 ✅ 完了
- [x] **04. 時計アプリ** - `webview_eval`によるC++→JS定期更新 ✅ 完了
- [x] **05. メモ帳** - ファイルI/O機能（既存パターンの応用） ✅ 完了

### 今後の学習プロジェクト（高度なJS-C++連携機能）

各プロジェクトで新しいJS-C++連携パターンを学習します。

#### ファイルダイアログとバイナリデータ処理
- [ ] **06. ファイルピッカー** - ネイティブファイルダイアログの表示、ファイルパスの取得
- [ ] **07. 画像ビューア** - Base64エンコード/デコード、バイナリデータの送受信

#### 非同期処理とストリーミング
- [ ] **08. ファイルアップローダー** - プログレス表示、チャンク転送、キャンセル機能
- [ ] **09. ログビューア** - リアルタイムストリーミング、バッファリング

#### マルチスレッド連携
- [ ] **10. システムモニター** - 複数スレッドからのJS更新、スレッドセーフな通信
- [ ] **11. 並列画像処理** - ワーカースレッドプール、結果の統合

#### メディアデバイスアクセス
- [ ] **12. カメラレコーダー** - WebRTC API経由でのカメラアクセス、動画データの処理
- [ ] **13. マイクレコーダー** - Web Audio APIとC++の連携、音声データのストリーミング
- [ ] **14. ウィンドウレコーダー** - 画面キャプチャAPI、特定ウィンドウの録画

#### イベントシステム
- [ ] **15. カスタムイベントデモ** - C++からのイベント発火、動的リスナー登録
- [ ] **16. ドラッグ&ドロップ** - ファイルドロップイベントの処理

#### 高度な最適化
- [ ] **17. 大容量データビューア** - メモリ効率的な転送、仮想スクロール
- [ ] **18. リアルタイムグラフ** - 高頻度データ更新の最適化

#### プラグインとセキュリティ
- [ ] **19. プラグインローダー** - 動的ライブラリロード、関数の動的登録
- [ ] **20. サンドボックスデモ** - セキュアな実行環境、権限管理

#### デバッグとツール連携
- [ ] **21. デバッガー統合** - C++ログのJSコンソール出力、スタックトレース
- [ ] **22. パフォーマンスプロファイラー** - 実行時間計測、ボトルネック分析

#### 総合プロジェクト
- [ ] **23. ミニIDE** - 上記技術を統合した開発環境

### 進捗記録
- **2025-01-07**: プロジェクト開始、01 Hello Worldアプリ完成
  - 基本的なWebview表示を実装
  - CMakeでのビルドシステム構築
  - Google Testを使用したテスト環境の整備
- **2025-01-08**: 基礎的なJS-C++連携パターンを学習（02-05完成）
  - `webview::bind`によるJS→C++呼び出し（02 カウンター）
  - 文字列データの双方向通信（03 テキストエコー）
  - `webview_eval`によるC++→JS定期更新（04 時計）
  - ファイルI/O機能の実装（05 メモ帳）